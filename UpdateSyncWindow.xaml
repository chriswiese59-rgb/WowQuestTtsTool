<Window x:Class="WowQuestTtsTool.UpdateSyncWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Update &amp; Sync - WoW Quest TTS Tool"
        Width="900"
        Height="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,15">
            <TextBlock Text="Update &amp; Sync" FontSize="24" FontWeight="Bold"/>
            <TextBlock Text="Erkennt neue und geaenderte Quests und vertont diese automatisch."
                       Foreground="#666" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Status-Bereich -->
        <GroupBox Grid.Row="1" Header="Aktueller Datenstand" Padding="10" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Letzter Snapshot -->
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Letzter Snapshot:" FontWeight="SemiBold" Margin="0,0,10,4"/>
                <TextBlock x:Name="LastSnapshotText" Grid.Row="0" Grid.Column="1" Text="Kein Snapshot vorhanden" Foreground="Gray"/>

                <!-- Letzter Sync -->
                <TextBlock Grid.Row="0" Grid.Column="2" Text="Letzter Sync:" FontWeight="SemiBold" Margin="20,0,10,4"/>
                <TextBlock x:Name="LastSyncText" Grid.Row="0" Grid.Column="3" Text="Noch nie" Foreground="Gray"/>

                <!-- WoW Build -->
                <TextBlock Grid.Row="1" Grid.Column="0" Text="WoW Build:" FontWeight="SemiBold" Margin="0,0,10,4"/>
                <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                    <TextBox x:Name="WowBuildTextBox" Width="100" Height="24" Padding="4,2" Text="11.2.7"/>
                    <TextBlock Text="(optional)" Foreground="Gray" VerticalAlignment="Center" Margin="8,0,0,0"/>
                </StackPanel>

                <!-- Audio Pack Version -->
                <TextBlock Grid.Row="1" Grid.Column="2" Text="Audio Pack Version:" FontWeight="SemiBold" Margin="20,0,10,4"/>
                <TextBox x:Name="AudioPackVersionTextBox" Grid.Row="1" Grid.Column="3" Width="80" Height="24" Padding="4,2" Text="1.0.0" HorizontalAlignment="Left"/>

                <!-- Vertonte Quests -->
                <TextBlock Grid.Row="2" Grid.Column="0" Text="Vertonte Quests:" FontWeight="SemiBold" Margin="0,0,10,0"/>
                <TextBlock x:Name="TotalVoicedText" Grid.Row="2" Grid.Column="1" Text="0"/>

                <!-- Sprache -->
                <TextBlock Grid.Row="2" Grid.Column="2" Text="Sprache:" FontWeight="SemiBold" Margin="20,0,10,0"/>
                <TextBlock x:Name="LanguageText" Grid.Row="2" Grid.Column="3" Text="deDE"/>
            </Grid>
        </GroupBox>

        <!-- Scan-Bereich -->
        <GroupBox Grid.Row="2" Header="Quest-Scan" Padding="10" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Scan Button -->
                <Button x:Name="ScanButton" Grid.Row="0" Grid.Column="0"
                        Content="Questdaten scannen (Diff erstellen)"
                        Width="250" Height="32"
                        Click="OnScanQuestsClick"
                        Background="#2196F3" Foreground="White" FontWeight="SemiBold"/>

                <!-- Statistiken -->
                <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="20,0,0,0" VerticalAlignment="Center">
                    <Border Background="#E8F5E9" CornerRadius="4" Padding="8,4" Margin="0,0,8,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Neu: " FontWeight="SemiBold" Foreground="#2E7D32"/>
                            <TextBlock x:Name="NewCountText" Text="0" Foreground="#2E7D32" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                    <Border Background="#FFF3E0" CornerRadius="4" Padding="8,4" Margin="0,0,8,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Geaendert: " FontWeight="SemiBold" Foreground="#E65100"/>
                            <TextBlock x:Name="ChangedCountText" Text="0" Foreground="#E65100" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                    <Border Background="#FFEBEE" CornerRadius="4" Padding="8,4" Margin="0,0,8,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Entfernt: " FontWeight="SemiBold" Foreground="#C62828"/>
                            <TextBlock x:Name="RemovedCountText" Text="0" Foreground="#C62828" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                    <Border Background="#ECEFF1" CornerRadius="4" Padding="8,4">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Unveraendert: " FontWeight="SemiBold" Foreground="#546E7A"/>
                            <TextBlock x:Name="UnchangedCountText" Text="0" Foreground="#546E7A"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Filter -->
                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal" Margin="0,10,0,0">
                    <TextBlock Text="Filter:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <CheckBox x:Name="ShowNewCheckBox" Content="Neue" IsChecked="True" Margin="0,0,10,0"
                              Checked="OnFilterChanged" Unchecked="OnFilterChanged"/>
                    <CheckBox x:Name="ShowChangedCheckBox" Content="Geaenderte" IsChecked="True" Margin="0,0,10,0"
                              Checked="OnFilterChanged" Unchecked="OnFilterChanged"/>
                    <CheckBox x:Name="ShowRemovedCheckBox" Content="Entfernte" Margin="0,0,10,0"
                              Checked="OnFilterChanged" Unchecked="OnFilterChanged"/>
                    <CheckBox x:Name="ShowUnchangedCheckBox" Content="Unveraenderte" Margin="0,0,20,0"
                              Checked="OnFilterChanged" Unchecked="OnFilterChanged"/>
                    <TextBlock Text="Zone:" VerticalAlignment="Center" Margin="0,0,4,0"/>
                    <ComboBox x:Name="ZoneFilterCombo" Width="150" Height="24" SelectionChanged="OnZoneFilterChanged">
                        <ComboBoxItem Content="Alle Zonen" IsSelected="True"/>
                    </ComboBox>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Diff-Liste -->
        <GroupBox Grid.Row="3" Header="Gefundene Unterschiede" Padding="10">
            <DataGrid x:Name="DiffDataGrid"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      SelectionMode="Extended"
                      GridLinesVisibility="Horizontal"
                      AlternatingRowBackground="#FAFAFA">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Typ" Binding="{Binding DiffTypeShortName}" Width="70">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding DiffType}" Value="New">
                                        <Setter Property="Foreground" Value="#2E7D32"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding DiffType}" Value="Changed">
                                        <Setter Property="Foreground" Value="#E65100"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding DiffType}" Value="Removed">
                                        <Setter Property="Foreground" Value="#C62828"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ID" Binding="{Binding QuestId}" Width="60"/>
                    <DataGridTextColumn Header="Titel" Binding="{Binding Title}" Width="*"/>
                    <DataGridTextColumn Header="Zone" Binding="{Binding Zone}" Width="120"/>
                    <DataGridTextColumn Header="Kat" Binding="{Binding CategoryShortName}" Width="50"/>
                    <DataGridCheckBoxColumn Header="Main" Binding="{Binding IsMainStory}" Width="45"/>
                    <DataGridCheckBoxColumn Header="Grp" Binding="{Binding IsGroupQuest}" Width="40"/>
                    <DataGridTextColumn Header="Alter Hash" Binding="{Binding OldHash}" Width="80"/>
                    <DataGridTextColumn Header="Neuer Hash" Binding="{Binding NewHash}" Width="80"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- Progress-Bereich -->
        <Grid Grid.Row="4" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <ProgressBar x:Name="ProgressBar" Grid.Column="0" Height="24" Minimum="0" Maximum="100" Value="0"/>
            <TextBlock x:Name="ProgressText" Grid.Column="1" Margin="10,0,0,0" VerticalAlignment="Center" Width="60"/>
        </Grid>

        <!-- Log-Bereich -->
        <GroupBox Grid.Row="5" Header="Log" Padding="10" Margin="0,10,0,0" Height="120">
            <TextBox x:Name="LogTextBox"
                     IsReadOnly="True"
                     TextWrapping="Wrap"
                     VerticalScrollBarVisibility="Auto"
                     FontFamily="Consolas"
                     FontSize="11"/>
        </GroupBox>

        <!-- Aktions-Buttons -->
        <Grid Grid.Row="6" Margin="0,15,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Linke Buttons -->
            <CheckBox x:Name="AutoExportCheckBox" Grid.Column="0" Content="Addon nach TTS automatisch exportieren"
                      IsChecked="True" VerticalAlignment="Center"/>

            <Button x:Name="ApplyButton" Grid.Column="1"
                    Content="Neue &amp; geaenderte Quests vertonen"
                    Width="220" Height="36" Margin="20,0,0,0"
                    Click="OnApplyTtsClick"
                    Background="#4CAF50" Foreground="White" FontWeight="SemiBold"
                    IsEnabled="False"/>

            <!-- Rechte Buttons -->
            <Button x:Name="CreateSnapshotButton" Grid.Column="3"
                    Content="Initial-Snapshot erstellen"
                    Width="160" Height="36" Margin="0,0,10,0"
                    Click="OnCreateInitialSnapshotClick"
                    ToolTip="Erstellt einen Snapshot ohne TTS-Generierung (nur zum Speichern des aktuellen Stands)"/>

            <Button x:Name="CloseButton" Grid.Column="4"
                    Content="Schliessen"
                    Width="100" Height="36"
                    Click="OnCloseClick"
                    IsCancel="True"/>
        </Grid>
    </Grid>
</Window>
